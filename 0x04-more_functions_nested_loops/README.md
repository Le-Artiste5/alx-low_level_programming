This has to do with more functions and nested loops
